<?php

/**
 * @file
 * Provides computed display fields for Stanford Person title alt override.
 *
 * This module adds computed fields to the stanford_person content type,
 * allowing display of alternative or original title values.
 */

use Drupal\Core\Entity\EntityTypeInterface;
use Drupal\Core\Field\BaseFieldDefinition;

/**
 * Implements hook_entity_base_field_info().
 */
function sdss_person_title_override_entity_base_field_info(EntityTypeInterface $entity_type) {
  $fields = [];
  if ($entity_type->id() == 'node') {

    // Computed field for displaying the full title; use alt_title if present.
    $fields['sdss_computed_full_title'] = BaseFieldDefinition::create('sdss_computed_full_title')
      ->setLabel(t('Full Title (with Alt Override)'))
      ->setDescription(t('Displays alt_title if set, otherwise full_title.'))
      ->setTranslatable(TRUE)
      ->setDisplayConfigurable('view', TRUE)
      ->setDisplayConfigurable('form', FALSE)
      ->setRequired(FALSE)
      ->setTargetBundle('stanford_person');

    // Computed field for displaying the short title; use alt_title if present.
    $fields['sdss_computed_short_title'] = BaseFieldDefinition::create('sdss_computed_short_title')
      ->setLabel(t('Short Title (with Alt Override)'))
      ->setDescription(t('Displays alt_title if set, otherwise short_title.'))
      ->setTranslatable(TRUE)
      ->setDisplayConfigurable('view', TRUE)
      ->setDisplayConfigurable('form', FALSE)
      ->setRequired(FALSE)
      ->setTargetBundle('stanford_person');
  }
  return $fields;
}
