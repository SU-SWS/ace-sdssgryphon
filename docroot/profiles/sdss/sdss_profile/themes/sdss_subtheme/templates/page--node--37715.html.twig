{#
/**
 * @file
 * Test Framework template.
 */
#}

{%- extends "@stanford_basic/page.html.twig" -%}

{# Masthead Section. #}
{%- block block_header -%}
  {%- if page.header or page.search or page.menu -%}
    <header class="su-masthead su-masthead--right">

      {% block block_skiplinks %}
        <a href="#main-content" class="visually-hidden focusable su-skipnav su-skipnav--content">
          {{ 'Skip to main content'|t }}
        </a>
        <a href="#secondary-navigation" class="visually-hidden focusable su-skipnav su-skipnav--secondary">
          {{ 'Skip to secondary navigation'|t }}
        </a>
      {% endblock %}

      {# Brand Bar #}
      {%- block block_brandbar -%}
        {%- include template_brand_bar with { modifier_class : brand_bar_variant } -%}
      {%- endblock -%}

      {# Help Section #}
      {%- block block_help -%}
        {{ page.help }}
      {%- endblock -%}

      {%- if header_layout_variant == 'option_a' -%}
        {% include '@sdss_subtheme/templates/header--option-a.html.twig' %}
      {%- else -%}
        {% include '@sdss_subtheme/templates/header--default.html.twig' %}
      {%- endif -%}
        </header>
      {%- endif -%}

  {# Newsroom Section. #}
  {%- if page.newsroom -%}
    <section class="newsroom-wrapper" aria-labelledby="news-research">
      {{ page.newsroom }}
    </section>
  {%- endif -%}

{%- endblock -%}

{%- block block_main -%}

  {% set topics = [ 
    { 'slug': 'biotechnology', 'title': 'Biotechnology' },
    { 'slug': 'built-environment', 'title': 'Built environment' },
    { 'slug': 'built-environment2', 'title': 'Built environment' },
    { 'slug': 'built-environment3', 'title': 'Built environment' },
    { 'slug': 'built-environment4', 'title': 'Built environment' },
    { 'slug': 'built-environment5', 'title': 'Built environment' },
    { 'slug': 'built-environment6', 'title': 'Built environment' },
    { 'slug': 'built-environment7', 'title': 'Built environment' },
    { 'slug': 'built-environment8', 'title': 'Built environment' },
    { 'slug': 'built-environment9', 'title': 'Built environment' },
    { 'slug': 'built-environment10', 'title': 'Built environment' },
  ] %}

  {% set impactPathways = [ 
    { 'slug': 'policy', 'title': 'Policy' },
    { 'slug': 'technology-commercialization', 'title': 'Technology & Commercialization' },
    { 'slug': 'other-enablers', 'title': 'Other Enablers' },
  ] %}

  {% set status = [ 
    { 'slug': 'active', 'title': 'Active' },
    { 'slug': 'graduated', 'title': 'Graduated' },
  ] %}

  {% set projects = [
    { 'link': '#', 'title': 'Ocean carbon capture and alkalinity enhancement', 'image': '/dist/img/temp/image1.jpg', 'flagship': 'Water' },
    { 'link': '#', 'title': 'Making Zero-carbon Cement at Scale', 'image': '/dist/img/temp/image2.jpg', 'flagship': 'Food and Agriculture' },
    { 'link': '#', 'title': 'A Blue Food Transformation for the Pacific', 'image': '/dist/img/temp/image3.jpg', 'flagship': 'Water' },
    { 'link': '#', 'title': 'Electrochemical Nutrient Recovery from Wastewater: Creating Circular Nutrient Economies', 'image': '/dist/img/temp/image4.jpg', 'flagship': 'Water' },
    { 'link': '#', 'title': 'Designing Efficient and Sustainable Water Reallocation in California', 'image': '/dist/img/temp/image5.jpg', 'flagship': 'Water' },
    { 'link': '#', 'title': 'Achieving the Human Right to Water in California', 'image': '/dist/img/temp/image6.jpg', 'flagship': 'Water' },
    { 'link': '#', 'title': 'Partnering with Domestic and International Players For More-Effective Energy-Transition Policies and Financing in Indonesia and Vietnam', 'image': '/dist/img/temp/image7.jpg', 'flagship': 'Water' },
    { 'link': '#', 'title': 'Performance-based co-design of natural ventilation systems  to reduce cooling demand and improve thermal comfort in South East Asia', 'image': '/dist/img/temp/image8.jpg', 'flagship': 'Climate Adaptation' },
    { 'link': '#', 'title': 'Accelerator for Environmental Justice (EJ) at Stanford', 'image': '/dist/img/temp/image9.jpg', 'flagship': 'Climate Adaptation' },
    { 'link': '#', 'title': 'Accelerator for Environmental Justice (EJ) at Stanford', 'image': '/dist/img/temp/image9.jpg', 'flagship': 'Climate Adaptation' },
    { 'link': '#', 'title': 'Accelerator for Environmental Justice (EJ) at Stanford', 'image': '/dist/img/temp/image9.jpg', 'flagship': 'Climate Adaptation' },
    { 'link': '#', 'title': 'Accelerator for Environmental Justice (EJ) at Stanford', 'image': '/dist/img/temp/image9.jpg', 'flagship': 'Climate Adaptation' },
    { 'link': '#', 'title': 'Accelerator for Environmental Justice (EJ) at Stanford', 'image': '/dist/img/temp/image9.jpg', 'flagship': 'Climate Adaptation' },
    { 'link': '#', 'title': 'Accelerator for Environmental Justice (EJ) at Stanford', 'image': '/dist/img/temp/image9.jpg', 'flagship': 'Climate Adaptation' },
    { 'link': '#', 'title': 'Accelerator for Environmental Justice (EJ) at Stanford', 'image': '/dist/img/temp/image9.jpg', 'flagship': 'Climate Adaptation' },
    { 'link': '#', 'title': 'Accelerator for Environmental Justice (EJ) at Stanford', 'image': '/dist/img/temp/image9.jpg', 'flagship': 'Climate Adaptation' },
    { 'link': '#', 'title': 'Accelerator for Environmental Justice (EJ) at Stanford', 'image': '/dist/img/temp/image9.jpg', 'flagship': 'Climate Adaptation' },
  ]%}

  {% set flagships = [] %}
  {% for project in projects %}
    {% if project['flagship'] not in flagships %}
      {% set flagships = flagships|merge([project['flagship']]) %}
    {% endif %}
  {% endfor %}

  <div class = "su_projects">
    <div class = "su_projects__main">
      <div class = "su_projects__header">
        <h2>Projects</h2>
        <div class = "su_projects__toggle su_projects__toggle--grid-mode">
          <div class = "su_projects__toggle--grid">
            <img src="/{{ directory }}/dist/img/toggle-grid.svg" alt="" />
          </div>
          <div class = "su_projects__toggle--list">
            <img src="/{{ directory }}/dist/img/toggle-list.svg" alt="" />
          </div>
        </div>
      </div>

      <div class = "su_projects__grid">

        <div class = "su_projects__grid__inner">

          {% set x = 1 %}
          {% set overflow = false %}

          {% for project in projects %}

              {% if x == 10 %}
                {% set overflow = true %}
                </div>
                <div class = "su_projects__grid su_projects__grid--overflow">
              {% endif %}

              <a href = "{{ project['link'] }}" class = "su_projects__item">
                <div class = "su_projects__image">
                  <div class = "su_projects__image__inner" style = "background-image: url('/{{ directory }}{{ project['image'] }}')"></div>
                  <div class = "su_projects__flagship"><b>Flagship:</b> {{ project['flagship'] }}</div>
                </div>
                <h4>{{ project['title'] }}</h4>
              </a>

              {% set x = x + 1 %}

          {% endfor %}

        </div>

        {% if overflow %}
          <div class = "su_projects__grid__showmore__wrapper">
            <div class = "su_projects__grid__showmore">Show more</div>
          </div>
        {% endif %}

      </div>

      <div class = "su_projects__list hidden">

        <div class = "su_projects__list__inner">

          {% for flagship in flagships %}

            <div class = "su_projects__list__item">

              <h3>{{ flagship }}</h3>

              <div class = "su_projects__list__projects">

                {% for project in projects %}

                  {% if project['flagship'] == flagship %}

                    <a href = "{{ project['link'] }}" class = "su_projects__item">
                      <div class = "su_projects__image">
                        <div class = "su_projects__image__inner" style = "background-image: url('/{{ directory }}{{ project['image'] }}')"></div>
                      </div>
                      <h4>{{ project['title'] }}</h4>
                    </a>

                  {% endif %}

                {% endfor %}

              </div>

            </div>

          {% endfor %}

        </div>

      </div>

    </div>

    <div class = "su_projects__sidebar">
      <div class = "su_projects__sidebar__mobile_title">
        <button>Filters</button>
      </div>
      <div class = "su_projects__sidebar__inner">
        <div class = "su_projects__search">
          <input type = "text" id = "su_projects_search" placeholder = "Search" />
          <img src = "/{{ directory }}/dist/img/search.svg" alt = "" class = "su_projects__search__icon" />
        </div>

        <!-- Topics -->
        <div class = "su_projects__sidebar__section">
          <h3>Topics</h3>
          <div class = "su_projects__checklist">

            {% set x = 1 %}
            {% set overflowCount = 0 %}
            {% set overflow = false %}

            {% for term in topics %}

              {% if x == 7 %}
                {% set overflow = true %}
                </div>
                <div class = "su_projects__checklist su_projects__checklist--overflow">
              {% endif %}

              <div class = "su_projects__checkbox">
                <input type = "checkbox" id = "su_topics_{{ term['slug'] }}" />
                <label for = "su_topics_{{ term['slug'] }}">{{ term['title'] }}</label>
              </div>

              {% if overflow %}
                {% set overflowCount = overflowCount + 1%}
              {% endif %}

              {% set x = x + 1 %}

            {% endfor %}

          </div>

          {% if overflow %}
            <div class = "su_projects__checklist__showmore">See {{ overflowCount }} more</div>
          {% endif %}

        </div>

        <!-- Impact Pathways -->
        <div class = "su_projects__sidebar__section">
          <h3>Impact Pathways</h3>
          <div class = "su_projects__checklist">

            {% set x = 1 %}
            {% set overflowCount = 0 %}
            {% set overflow = false %}

            {% for term in impactPathways %}

              {% if x == 7 %}
                {% set overflow = true %}
                <div class = "su_projects__checklist__overflow">
              {% endif %}

              <div class = "su_projects__checkbox">
                <input type = "checkbox" id = "su_impact-pathways_{{ term['slug'] }}" />
                <label for = "su_impact-pathways_{{ term['slug'] }}">{{ term['title'] }}</label>
              </div>

              {% if overflow %}
                {% set overflowCount = overflowCount + 1%}
              {% endif %}

              {% set x = x + 1 %}

            {% endfor %}

            {% if overflow %}
              </div>
              <div class = "su_projects__checklist__showmore">See {{ overflowCount }} more</div>
            {% endif %}

          </div>
        </div>

        <!-- Status -->
        <div class = "su_projects__sidebar__section">
          <h3>Status</h3>
          <div class = "su_projects__checklist">

            {% set x = 1 %}
            {% set overflowCount = 0 %}
            {% set overflow = false %}

            {% for term in status %}

              {% if x == 7 %}
                {% set overflow = true %}
                <div class = "su_projects__checklist__overflow">
              {% endif %}

              <div class = "su_projects__checkbox">
                <input type = "checkbox" id = "su_status_{{ term['slug'] }}" />
                <label for = "su_status_{{ term['slug'] }}">{{ term['title'] }}</label>
              </div>

              {% if overflow %}
                {% set overflowCount = overflowCount + 1%}
              {% endif %}

              {% set x = x + 1 %}

            {% endfor %}

            {% if overflow %}
              </div>
              <div class = "su_projects__checklist__showmore">See {{ overflowCount }} more</div>
            {% endif %}

          </div>
        </div>
      </div>
    </div>
  </div>

  <script>
    document.querySelector('.su_projects__toggle').addEventListener('click', function(e) {
      e.currentTarget.classList.toggle('su_projects__toggle--grid-mode');
      e.currentTarget.classList.toggle('su_projects__toggle--list-mode');

      if(document.querySelector('.su_projects__list.hidden')) {
        document.querySelector('.su_projects__list').classList.remove('hidden');
        document.querySelector('.su_projects__grid').classList.add('hidden');
      } else {
        document.querySelector('.su_projects__list').classList.add('hidden');
        document.querySelector('.su_projects__grid').classList.remove('hidden');
      }
    });

    document.querySelector('.su_projects__sidebar__mobile_title button').addEventListener('click', function(e) {
      e.currentTarget.classList.toggle('active');
      document.querySelector('.su_projects__sidebar__inner').classList.toggle('active');
    });
  </script>
{%- endblock -%}

{%- block block_footer -%}
  <footer id="footer">
    {{ page.footer }}
    {%- include template_global_footer with { modifier_class : global_footer_variant }  -%}
  </footer>
  {% include '@sdss_subtheme/templates/components/popup/su-popup.html.twig' %}
{%- endblock -%}
